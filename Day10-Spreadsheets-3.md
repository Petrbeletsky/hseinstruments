# Google Таблицы: практикум 2

## Сводные таблицы. Основы количественного анализа результатов поиска в корпусе.

## Nota bene
* Если в корпусе найдено много примеров (например, более тысячи), достаточно проанализировать случайную выборку.
* Изучая вариативность какого-либо лингвистического явления, нужно либо создать две равные по объему случайные выборки, либо задать общий запрос, и из него сделать случайную выборку.
* Анализируя примеры, мы пытаемся понять, какие факторы (морфология, синтаксис, лексика, значение и т.д. слова или его контекста; жанр текста; пол автора и другая социолингвистическая информация) говорят в пользу выбора варианта А, а какие факторы говорят в пользу выбора Б. Не всегда выбор однозначен, но можно говорить о тенденциях.
* Определяя факторы, размечаем выборку (один фактор - одна колонка). Сводная таблица на основе такой разметки дает статистику совместной встречаемости признаков. Однако помните, что без (качественной) интерпретации, логических выводов такой количественный анализ бессмыслен. 
* У каждого автора могут быть свои языковые предпочтения. Кроме того, выбор слова или конструкции может предопределяться предшествующим контекстом. Поэтому делая случайную выборку, используйте правило: **один пример из автора** или **один пример из текста**.
* Все ошибочно попавшие в выборку примеры (или странные примеры, которые вам по какой-то причине не хочется использовать в анализе) нужно удалять или особо помечать.

## Задание 1: вариативность в конструкции _две небольшие коллекции_ / _две небольших коллекции_
Сформулируйте правило выбора падежа прилагательного, если числительное стоит в именительном падеже.
В запросе по подкорпусу художественной литературы Основного корпуса НКРЯ понадобится задать три элемента, идущих в таком порядке:<br>
имя числительное - _два_, _три_, _четыре_, _пять_, _шесть_, _семь_ (именительный падеж)<br>
имя прилагательное - любое (задайте падеж)<br>
имя существительное - любое (подумайте и задайте падеж).<br>
Между элементами не должно быть знаков препинания (задайте это с помощью дополнительных признаков).

## План исследования
### 1. Скачайте первые результаты выдачи в формате Excel. Вставьте их в Google-таблицу.

### 2. Примените правило "один случайный пример из автора":

    Создайте новый столбец и вставьте в ячейки сгенерированное случайное число (используя формулу =RAND() / =СЛЧИС() ). Отсортируйте примеры по этому столбцу.
![](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/Function%20RAND.png)

    Отсортируйте примеры по автору, а затем по названию текста. С помощью формулы условия, пометьте первый пример из каждого автора (например, цифрой 1). В части текстов, которые не имеют автора, пометьте первый пример из каждого текста.
![](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/Function_IF_cells_are_the_same.png)

    Переведите формулы в значения (copy - Edit:paste special as... values/text). 
Отсортируйте примеры. Все примеры, помеченные 1, окажутся вместе, остальные можно стереть.

### 3. Снова отсортируйте строки случайным образом (используя формулу генератора случайного числа). Ограничьте выборку 100 примерами, остальные можно стереть.

### 4. Создайте новые столбцы для предполагаемых факторов выбора варианта конструкции. Разметьте выборку, для быстроты вы можете дополнительно сортировать примеры по тем или иным полям и пользоваться формулами (например, выдачи подстроки).

### 5. Создайте сводную таблицу:

    Выделите столбцы, по которым будет создаваться сводная таблица. Обратите внимание, что они все должны иметь уникальные заголовки.<br>
Data - Pivot table... (Данные - Сводная таблица)
![](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/PivotTable1.png)

    В открывшемся новом листе для сводной таблицы добавьте категории (названия столцов) в строки (Rows) и в столбцы (Columns) сводной таблицы. В Excel/Calc это можно делать также перетаскиванием заголовков в таблицу.
![](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/PivotTable2.png)

    В поле Values (Значения) вставьте название любого заголовка и выберите опцию COUNTA (в Excel/Calc соответствует COUNT, Подсчет).
![](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/PivotTable3.png)

### 6. Дополнительные опции сводной таблицы: вложенные категории, сортировки, фильтры, графики.

    Для подсчета статистики по одному столбцу зону строк (Rows) заполнять не нужно. Две и более категории можно также располагать в столбце сводной таблице (Columns) вместе. Тогда данные будут разбиты на классы по первому признаку, а затем каждый класс будет разбит на подклассы по второму признаку.

    Можно также сортировать строки и столбцы сводной таблицы по названиям признаков (по алфавиту) и по количеству вхождений (например, от самого частого с самому редкому).
    Если вы не хотите видеть какие-то классы в сводной таблице, их можно исключить с помощью фильтров.

### 7. Сформулируйте кратко выводы 
О а) факторах, однозначно задающих выбор варианта А и Б и б) факторах, задающих тенденцию. Предскажите (уже без использования корпуса), как будут вести себя конструкции с числительным _оба_, _десять_?

Заполните [гугл-форму](https://docs.google.com/forms/d/e/1FAIpQLSdde2fkrM16305fTx1TlKj3MFtYbkUy0VLTxulqAldY-DbDEw/viewform).

## Дополнительные материалы.

### 8. Функция COUNTIF
Для подсчета статистики по значениям ячеек вы можете использовать функцию COUNTIF (СЧЁТЕСЛИ).
![](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/FunctionCOUNTIF.png)

### 9. Распределены ли частоты в таблице равномерно?
Допустим, у нас имеется таблица совместной встречаемости значений категорий X и Y (например, исторического периода и падежа прилагательного). Если бы употребление значений категории Y не зависило от того, какое значение принимает категория X, то мы были бы вправе ожидать равномерное распределение данных в таблице. На пересечении крупного класса категории X и крупного класса категории Y мы бы получили большое число, а на пересечении маленьких классов - маленькое число.
Таблица математического ожидания для нашей таблицы строится так:
значение в ячейке = Total в текущей строке * Total в текущем столбце / Grand Total
![](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/MarginalMeans.png)
Можно вычесть из таблицы с наблюдаемыми результатами таблицу с ожидаемыми результатами:
![](https://github.com/ElizavetaKuzmenko/Programming-and-computer-instruments/blob/master/images/MarginalMeans2.png)
В данном примере видно, что наблюдаемые и ожидаемые величины различаются незначительно. Поэтому мы можем сделать вывод, что за 70 последних лет, по данным корпусной выборки, в художественных текстах тенденции употребления родительного vs. именительного падежа в этой конструкции не изменились.

### 10. Хи-квадрат тест. 

В статистике используется ряд более строгих тестов, позволяющих сравнить наблюдаемые и теоретически ожидаемые величины. Один из них называется хи-квадрат тест (chi-squared test). Тест показывает вероятность того, что наблюдаемые в таблицы величины могли получиться в результате случая (а не из-за взаимозависимости двух исследуемых категорий). Если вероятность близка к 0, то, скорее всего, выбор некоторого значения категории X влияет на выбор другого значения в категории Y (и наоборот).
Если вы в своих исследованиях захотите провести тест хи-квадрат, мы рекомендуем пользоваться многочисленными онлайн-калькуляторами. ([Погуглить](https://www.google.ru/search?q=chi-square+test+online).)

## Задание 2
### Если ваша фамилия начинается на А-Й:  
* проанализируйте на корпусной выборке факторы употребления 2-го родительного падежа (типа _добавить сахарку_).  
### Если ваша фамилия начинается на К-О:  
* проанализируйте на корпусной выборке факторы употребления 2-й сравнительной степени (типа _побольше_).  
### Если ваша фамилия начинается на П-Я:  
* проанализируйте на корпусной выборке употребление нестандартных форм императива 

В задании 2 требуется собрать и доразметить выборки (равного размера, по 100 примеров) на исследуемую конструкцию/форму и альтернативный вариант (например, выборки на 2-й родительный и просто родительный падеж; на нестадартные и стандартные формы императива). Нужно исследовать, какие лексемы склонны к употреблению в заданной конструкции/форме, а также, какой контекст способствует такому употреблению. Покажите статистику распределения лексем или признаков контекста (с помощью сводной таблицы и графика).
