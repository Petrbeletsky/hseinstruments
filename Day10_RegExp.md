Практикум

# Поиск и замена. Регулярные выражения.

Что понадобится: Текстовый редактор NotePad++.
NB: Владельцы Mac-ов используют аналоги: редакторы TextWrangler или Fraise

## 1. Файл для работы - [dovlatov2.txt](http://hseinstruments.wikispaces.com/file/view/dovlatov2.txt/452225060/dovlatov2.txt)

Откройте файл с помощью NotePad++ (в проводнике контекстное меню Открыть с помощью...)


## 2. Что нужно сделать:

    убрать ударения
    заменить прописные буквы строчными в заголовке
    заменить пробелы в начале абзацев на табуляцию
    убрать "жесткие" концы строк, оставив деление на абзацы
    при этом аккуратно обработать слова с переносами
    убрать "лишние" пробелы (два и больше)


NB: Задание для тех, кто все уже умеет: выполнить все перечисленные операции + разметить начало и конец прямой речи с помощью тега <speech> + составить список слов, не содержащих ударения и буквы ё (используя возможности текстового редактора).


## 3. Уберите все знаки ударения

Выделите символ ударения, меню Поиск → Замена,

Найти: `ˊ` Заменить: (оставьте пустым) Режим поиска: обычный Заменить всё

Преобразуйте заголовок, заменив прописные буквы строчными

Правка → Преобразовать выделение → строчные


## 4. Кодировки

Типы кодировок текста для русского языка:

DOS, KOI8-R, Cyrillic Windows cp1251, Unicode (UTF-8 с/без BOM, цифровой подписи)

В меню "Кодировки" замените текущую на Windows-1251 (оцените эффект:), затем обратно на UTF-8 без BOM.

Если вы открываете файл и видите "кракозябры", то с помощью меню "Кодировки" можно подобрать правильную.

"Преобразовать в...": переводит файл в другую кодировку (затем файл нужно сохранить). Windows-1251 называется ANSI.

## 5. Вид → Отображение символов

Отметьте чекбоксы: Отображать пробелы и табуляции, отображать символы конца строки (отображать все символы).

## 6. Формат конца строки

Непечатаемые символы, обозначающие конец строки:

Win-формат: CR+LF \r\n

old-Mac-формат: CR \r

UNIX-формат: LF \n

Справа показаны эскейп-символы (\r, \n), которые используются при поиске и замене в расширенном режиме и в режиме регулярных выражений.

## 7. Вид → Перенос строк

автоматически переносит текст на новую строку, как в Word. Видимые концы строк при этом не сохраняются (являются "мягкими").


## 8. Поиск и замена в расширенном режиме

Табуляция: экскейп-символ \t

Замените 5 пробелов в начале строки на знак табуляции.

Найти: ˽˽˽˽˽ (5 пробелов)

Заменить: \t Режим поиска: расширенный


Замените концы строк на пробел


Найти: \r\n Заменить: ˽ (1 пробел) Режим поиска: расширенный


Верните концы строк в конце абзацев.
(догадайтесь, как. Подсказка: абзацы начинаются с табуляции. \t нужно заменить на нее же, но перед ней вставить......)


## 9. Режим поиска "Регулярные выражения"


`^` - начало строки, `$` - конец строки

`к[аоиу]т` - найдет кат, кот, кит, кут

`[а-яё]` - найдет все буквы русского алфавита

`[0-9a-z@_.]` - все знаки, допустимые в адресе эл. почты

Узнайте, есть ли в тексте латинские буквы?


`[^а-я]` - "крышка" обозначает НЕ

`[^!]$`- найдет концы абзацев, не заканчивающиеся на восклицательный знак


`.` - любой символ

`.+` - повтор (любого символа) 1 или более раз

`.*` - повтор (любого символа) 0 или более раз


`е+` - найдет е, ее, еее...

`[нм]+` - найдет сочетания нн, мм, нм, мн, ммм, нннн, мнннннм...

`л.+` - найдет букву л и далее все символы до конца строки

`л[а-яё]+` - что найдется здесь?

`˽я[а-яё]*` - (в начале пробел) найдет слова, начинающиеся с я, в том числе слово я

Этот поиск "жадный" - он будет искать строку максимальной длины, соответствующую условию в "Искать".

Запрос <.*> в строке <p>что-то здесь</p> найдет всю строку целиком: <p>что-то здесь</p>

Нежадный ("ленивый") поиск:

`.+?`

`.*?`

-- ищет до первого вхождения символа, указанного после ?

`<.*?>` - найдет тег <p>, затем тег <p>: <p>что-то здесь</p>

`ч.+о` - найдет "что-то"

`ч.+?о` - найдет "что"



## 10. Найдите и замените "лишние" пробелы в тексте.

Найдите с помощью "ленивого поиска" последовательность букв от пробела до пробела (слово)


## 11. Регулярные выражения: эскейп-символы

`\.` - ищет точку

`\\` - ищет обратный слэш

`\+`, `\*`, `\[`, `\]`, `\(` - ищет плюс, звездочку, знаки скобок и т.п.


Найдите все концы абзацев, заканчивающиеся на точку.



## 12. Использование условий поиска

Заключите все условие или его части в скобки. В поле "Заменить"

`\1`, `\2`, `\3` - обозначает части поиска

`([^ ]+)-∙([^ ]+)` → `\1\2` - уберет дефисы, оставшиеся после удаления жестких концов строк.

Задание: Задайте маску поиска конца прямой речи.

Подсказка: используйте `[ ]` со списком знаков препинания


## 13. Предупреждение: язык регулярных выражений может немного различаться в разных редакторах и в разных языках программирования (нотацией), но в целом набор приемов и принципы поиска одинаковы.

Шифр для знатоков: в NotePad++ нет: `{20,40}`, вместо `\0` использовать `\1`.

[Еще один краткий курс по регулярным выражениям в NotePad++](http://markantoniou.blogspot.ru/2008/06/notepad-how-to-use-regular-expressions.html)


## Дополнительное задание:
создайте список слов по вашему файлу.

0) сохраните содержимое файла в новый файл dovlatov_wordlist.txt  
1) переведите все слова в нижний регистр (Edit -> Convert case to...)   
2) сделайте так, чтобы каждое слово шло с новой строки, вставив концы строк  
3) сделайте так, чтобы каждый знак препинания также шел с новой строки  
4) отсортируйте строки по алфавиту (Edit -> Line operations -> Sort lines lexicographically ascending).  
5) удалите повторяющиеся строки с помощью регулярных выражений  
    `^(.*\r\n)\1+`  

## Чеклист по практикуму в классе:

файлы dovlatov2.txt лежат в репозитории в папке Day10.
